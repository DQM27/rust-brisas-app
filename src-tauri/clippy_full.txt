warning: `crate` references the macro call's crate
  --> src\macros.rs:43:30
   |
43 |             Ok(user) => Ok::<crate::models::user::SessionUser, crate::services::surrealdb_authorization::AuthError>(user),
   |                              ^^^^^ help: to reference the macro definition's crate, use: `$crate`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#crate_in_macro_def
   = note: `-W clippy::crate-in-macro-def` implied by `-W clippy::all`
   = help: to override `-W clippy::all` add `#[allow(clippy::crate_in_macro_def)]`

warning: long literal lacking separators
   --> src\export\excel\builder.rs:133:59
    |
133 |         .set_background_color(rust_xlsxwriter::Color::RGB(0xD9D9D9)) // Gris claro
    |                                                           ^^^^^^^^ help: consider: `0x00D9_D9D9`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unreadable_literal
    = note: `-W clippy::unreadable-literal` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::unreadable_literal)]`

warning: this argument is passed by value, but not consumed in the function body
  --> src\commands\app_commands.rs:15:39
   |
15 | pub fn set_window_decorations(window: Window, decorations: bool) -> Result<(), String> {
   |                                       ^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
   = note: `-W clippy::needless-pass-by-value` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::needless_pass_by_value)]`
help: consider taking a reference instead
   |
15 | pub fn set_window_decorations(window: &Window, decorations: bool) -> Result<(), String> {
   |                                       +

warning: this argument is passed by value, but not consumed in the function body
  --> src\commands\app_commands.rs:21:32
   |
21 | pub fn set_window_size(window: Window, width: f64, height: f64) -> Result<(), String> {
   |                                ^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
   |
21 | pub fn set_window_size(window: &Window, width: f64, height: f64) -> Result<(), String> {
   |                                +

warning: called `unwrap` on `custom_path` after checking its variant with `is_some`
  --> src\commands\audio_commands.rs:27:24
   |
26 |         if use_custom && custom_path.is_some() {
   |                          --------------------- the check is happening here
27 |             let path = custom_path.unwrap();
   |                        ^^^^^^^^^^^^^^^^^^^^
   |
   = help: try using `if let` or `match`
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_unwrap
   = note: `-W clippy::unnecessary-unwrap` implied by `-W clippy::all`
   = help: to override `-W clippy::all` add `#[allow(clippy::unnecessary_unwrap)]`

warning: temporary with significant `Drop` can be early dropped
  --> src\commands\audio_commands.rs:77:17
   |
76 | /     {
77 | |         let mut config_guard = config.write().map_err(|e| e.to_string())?;
   | |                 ^^^^^^^^^^^^
78 | |         config_guard.audio.custom_sound_path = Some(dest_str.clone());
79 | |         config_guard.audio.use_custom = true;
...  |
87 | |             .map_err(|e| e.to_string())?;
88 | |     }
   | |_____- temporary `config_guard` is currently being dropped at the end of its contained scope
   |
   = note: this might lead to unnecessary resource contention
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
   = note: `-W clippy::significant-drop-tightening` implied by `-W clippy::nursery`
   = help: to override `-W clippy::nursery` add `#[allow(clippy::significant_drop_tightening)]`
help: drop the temporary after the end of its last usage
   |
79 ~         config_guard.audio.use_custom = true;
80 +         drop(config_guard);
   |

warning: use Option::map_or_else instead of an if let/else
  --> src\commands\audio_commands.rs:80:27
   |
80 |           let config_path = if let Some(d) = dirs::data_local_dir() {
   |  ___________________________^
81 | |             d.join("Brisas").join("brisas.toml")
82 | |         } else {
83 | |             std::path::PathBuf::from("./config/brisas.toml")
84 | |         };
   | |_________^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("./config/brisas.toml"), |d| d.join("Brisas").join("brisas.toml"))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
   = note: `-W clippy::option-if-let-else` implied by `-W clippy::nursery`
   = help: to override `-W clippy::nursery` add `#[allow(clippy::option_if_let_else)]`

warning: temporary with significant `Drop` can be early dropped
   --> src\commands\audio_commands.rs:109:13
    |
108 |   ) -> Result<(), String> {
    |  _________________________-
109 | |     let mut config_guard = config.write().map_err(|e| e.to_string())?;
    | |             ^^^^^^^^^^^^
110 | |     config_guard.audio.use_custom = use_custom;
...   |
119 | |     Ok(())
120 | | }
    | |_- temporary `config_guard` is currently being dropped at the end of its contained scope
    |
    = note: this might lead to unnecessary resource contention
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
help: merge the temporary construction with its single usage
    |
109 ~     
110 +     config.write().map_err(|e| e.to_string())?.;
111 ~     
    |

warning: use Option::map_or_else instead of an if let/else
   --> src\commands\audio_commands.rs:112:23
    |
112 |       let config_path = if let Some(d) = dirs::data_local_dir() {
    |  _______________________^
113 | |         d.join("Brisas").join("brisas.toml")
114 | |     } else {
115 | |         std::path::PathBuf::from("./config/brisas.toml")
116 | |     };
    | |_____^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("./config/brisas.toml"), |d| d.join("Brisas").join("brisas.toml"))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: use Option::map_or_else instead of an if let/else
  --> src\commands\config_commands.rs:39:23
   |
39 |       let config_path = if let Some(data_dir) = dirs::data_local_dir() {
   |  _______________________^
40 | |         data_dir.join("Brisas").join("brisas.toml")
41 | |     } else {
42 | |         std::path::PathBuf::from("./config/brisas.toml")
43 | |     };
   | |_____^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("./config/brisas.toml"), |data_dir| data_dir.join("Brisas").join("brisas.toml"))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: temporary with significant `Drop` can be early dropped
  --> src\commands\config_commands.rs:61:13
   |
58 |   ) -> Result<(), ConfigError> {
   |  ______________________________-
59 | |     info!("Actualizando configuraci├│n de audio: {alert_sound}");
60 | |
61 | |     let mut config_guard = config
   | |             ^^^^^^^^^^^^
...  |
76 | |     Ok(())
77 | | }
   | |_- temporary `config_guard` is currently being dropped at the end of its contained scope
   |
   = note: this might lead to unnecessary resource contention
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
help: merge the temporary construction with its single usage
   |
61 ~     
62 +     config
63 +         .write()
64 ~         .map_err(|e| ConfigError::Message(format!("Error al escribir configuraci├│n: {e}")))?.;
65 |
66 ~     
   |

warning: use Option::map_or_else instead of an if let/else
  --> src\commands\config_commands.rs:67:23
   |
67 |       let config_path = if let Some(data_dir) = dirs::data_local_dir() {
   |  _______________________^
68 | |         data_dir.join("Brisas").join("brisas.toml")
69 | |     } else {
70 | |         std::path::PathBuf::from("./config/brisas.toml")
71 | |     };
   | |_____^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("./config/brisas.toml"), |data_dir| data_dir.join("Brisas").join("brisas.toml"))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: function call inside of `ok_or`
   --> src\commands\contratista_commands.rs:253:28
    |
253 |         session.get_user().ok_or(ContratistaError::Unauthorized("Sesi├│n no v├ílida".to_string()))?;
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| ContratistaError::Unauthorized("Sesi├│n no v├ílida".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
    = note: `-W clippy::or-fun-call` implied by `-W clippy::nursery`
    = help: to override `-W clippy::nursery` add `#[allow(clippy::or_fun_call)]`

warning: function call inside of `ok_or`
   --> src\commands\contratista_commands.rs:275:28
    |
275 |         session.get_user().ok_or(ContratistaError::Unauthorized("Sesi├│n no v├ílida".to_string()))?;
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| ContratistaError::Unauthorized("Sesi├│n no v├ílida".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\commands\system_commands.rs:27:41
   |
27 |                 LASTINPUTINFO { cbSize: std::mem::size_of::<LASTINPUTINFO>() as u32, dwTime: 0 };
   |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
   = note: `-W clippy::cast-possible-truncation` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::cast_possible_truncation)]`
help: ... or use `try_from` and handle the error accordingly
   |
27 -                 LASTINPUTINFO { cbSize: std::mem::size_of::<LASTINPUTINFO>() as u32, dwTime: 0 };
27 +                 LASTINPUTINFO { cbSize: u32::try_from(std::mem::size_of::<LASTINPUTINFO>()), dwTime: 0 };
   |

warning: function call inside of `ok_or`
  --> src\commands\ingreso_commands.rs:98:10
   |
98 |         .ok_or(AlertaError::Validation("Sesi├│n de supervisor no v├ílida o expirada".to_string()))?;
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| AlertaError::Validation("Sesi├│n de supervisor no v├ílida o expirada".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
  --> src\commands\ingreso_visita_commands.rs:22:10
   |
22 |         .ok_or(IngresoVisitaError::Unauthorized("Sesi├│n requerida".to_string()))?;
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| IngresoVisitaError::Unauthorized("Sesi├│n requerida".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
  --> src\commands\ingreso_visita_commands.rs:50:10
   |
50 |         .ok_or(IngresoVisitaError::Unauthorized("Sesi├│n requerida".to_string()))?;
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| IngresoVisitaError::Unauthorized("Sesi├│n requerida".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: this argument is passed by value, but not consumed in the function body
  --> src\commands\keyring_commands.rs:47:34
   |
47 | pub fn is_app_configured(config: State<'_, AppConfigState>) -> bool {
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
   |
47 | pub fn is_app_configured(config: &State<'_, AppConfigState>) -> bool {
   |                                  +

warning: use Option::map_or instead of an if let/else
  --> src\commands\keyring_commands.rs:48:5
   |
48 | /     if let Ok(guard) = config.read() {
49 | |         guard.setup.is_configured && ks::is_fully_configured()
50 | |     } else {
51 | |         false
52 | |     }
   | |_____^ help: try: `config.read().map_or(false, |guard| guard.setup.is_configured && ks::is_fully_configured())`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: this argument is passed by value, but not consumed in the function body
  --> src\commands\keyring_commands.rs:57:28
   |
57 | pub fn needs_setup(config: State<'_, AppConfigState>) -> bool {
   |                            ^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
   |
57 | pub fn needs_setup(config: &State<'_, AppConfigState>) -> bool {
   |                            +

warning: use Option::map_or instead of an if let/else
  --> src\commands\keyring_commands.rs:58:5
   |
58 | /     if let Ok(guard) = config.read() {
59 | |         !guard.setup.is_configured || !ks::is_fully_configured()
60 | |     } else {
61 | |         true
62 | |     }
   | |_____^ help: try: `config.read().map_or(true, |guard| !guard.setup.is_configured || !ks::is_fully_configured())`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: temporary with significant `Drop` can be early dropped
   --> src\commands\keyring_commands.rs:91:17
    |
 90 | /     {
 91 | |         let mut config_guard = config.write().map_err(|e| {
    | |                 ^^^^^^^^^^^^
 92 | |             KeyringError::Message(format!("Error escribiendo configuraci├│n: {e}"))
 93 | |         })?;
...   |
109 | |             .map_err(|e| KeyringError::Message(format!("Error guardando configuraci├│n: {e}")))?;
110 | |     }
    | |_____- temporary `config_guard` is currently being dropped at the end of its contained scope
    |
    = note: this might lead to unnecessary resource contention
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
help: drop the temporary after the end of its last usage
    |
100 ~         config_guard.terminal.ubicacion = input.terminal_location;
101 +         drop(config_guard);
    |

warning: use Option::map_or_else instead of an if let/else
   --> src\commands\keyring_commands.rs:102:27
    |
102 |           let config_path = if let Some(data_dir) = dirs::data_local_dir() {
    |  ___________________________^
103 | |             data_dir.join("Brisas").join("brisas.toml")
104 | |         } else {
105 | |             std::path::PathBuf::from("brisas.toml")
106 | |         };
    | |_________^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("brisas.toml"), |data_dir| data_dir.join("Brisas").join("brisas.toml"))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: this function has too many lines (122/100)
   --> src\commands\keyring_commands.rs:181:1
    |
181 | pub async fn test_keyring(session: State<'_, SessionState>) -> Result<String, KeyringError> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#too_many_lines
    = note: `-W clippy::too-many-lines` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::too_many_lines)]`

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\commands\keyring_commands.rs:189:5
    |
189 |     use crate::services::keyring_windows as keyring_impl;
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements
    = note: `-W clippy::items-after-statements` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::items_after_statements)]`

warning: temporary with significant `Drop` can be early dropped
   --> src\commands\keyring_commands.rs:334:13
    |
325 |   ) -> Result<(), KeyringError> {
    |  _______________________________-
326 | |     require_perm!(session, "config:delete", "Reseteo total de credenciales")
327 | |         .map_err(|e| KeyringError::Message(e.to_string()))?;
328 | |     if !confirm {
...   |
334 | |     let mut config_guard = config
    | |             ^^^^^^^^^^^^
...   |
354 | |     Ok(())
355 | | }
    | |_- temporary `config_guard` is currently being dropped at the end of its contained scope
    |
    = note: this might lead to unnecessary resource contention
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
help: drop the temporary after the end of its last usage
    |
343 ~     config_guard.terminal.ubicacion = String::new();
344 +     drop(config_guard);
    |

warning: use Option::map_or_else instead of an if let/else
   --> src\commands\keyring_commands.rs:345:23
    |
345 |       let config_path = if let Some(data_dir) = dirs::data_local_dir() {
    |  _______________________^
346 | |         data_dir.join("Brisas").join("brisas.toml")
347 | |     } else {
348 | |         std::path::PathBuf::from("brisas.toml")
349 | |     };
    | |_____^ help: try: `dirs::data_local_dir().map_or_else(|| std::path::PathBuf::from("brisas.toml"), |data_dir| data_dir.join("Brisas").join("brisas.toml"))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: function call inside of `ok_or`
  --> src\commands\role_commands.rs:54:10
   |
54 |         .ok_or(RoleError::Unauthorized("Sesi├│n requerida para calcular visibilidad".to_string()))?;
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| RoleError::Unauthorized("Sesi├│n requerida para calcular visibilidad".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
   --> src\commands\role_commands.rs:109:10
    |
109 |         .ok_or(RoleError::Unauthorized("Sesi├│n administrativa requerida".to_string()))?;
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| RoleError::Unauthorized("Sesi├│n administrativa requerida".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: use Option::map_or_else instead of an if let/else
  --> src\config\manager.rs:29:5
   |
29 | /     if let Some(data_dir) = dirs::data_local_dir() {
30 | |         data_dir.join("Brisas").join("brisas.toml")
31 | |     } else {
32 | |         PathBuf::from("./config/brisas.toml")
33 | |     }
   | |_____^ help: try: `dirs::data_local_dir().map_or_else(|| PathBuf::from("./config/brisas.toml"), |data_dir| data_dir.join("Brisas").join("brisas.toml"))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: this function's return value is unnecessarily wrapped by `Result`
   --> src\config\manager.rs:136:1
    |
136 | fn generate_hardware_id() -> Result<String, Box<dyn std::error::Error>> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
    = note: `-W clippy::unnecessary-wraps` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::unnecessary_wraps)]`
help: remove `Result` from the return type...
    |
136 - fn generate_hardware_id() -> Result<String, Box<dyn std::error::Error>> {
136 + fn generate_hardware_id() -> std::string::String {
    |
help: ...and then remove the surrounding `Ok()` from returning expressions
    |
141 ~             return format!("HW-{mac_str}");
142 |         }
...
145 |     // Fallback: UUID aleatorio
146 ~     format!("HW-{}", uuid::Uuid::new_v4().to_string().replace('-', ""))
    |

warning: this `if let` can be collapsed into the outer `if let`
   --> src\config\manager.rs:139:9
    |
139 | /         if let Some(mac) = mac {
140 | |             let mac_str = mac.to_string().replace(':', "");
141 | |             return Ok(format!("HW-{mac_str}"));
142 | |         }
    | |_________^
    |
help: the outer pattern can be modified to include the inner pattern
   --> src\config\manager.rs:138:15
    |
138 |     if let Ok(mac) = mac_address::get_mac_address() {
    |               ^^^ replace this binding
139 |         if let Some(mac) = mac {
    |                ^^^^^^^^^ with this pattern
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#collapsible_match
    = note: `-W clippy::collapsible-match` implied by `-W clippy::all`
    = help: to override `-W clippy::all` add `#[allow(clippy::collapsible_match)]`

warning: use Option::map_or_else instead of an if let/else
   --> src\config\manager.rs:172:5
    |
172 | /     if let Some(data_dir) = dirs::data_local_dir() {
173 | |         let dir = data_dir.join("Brisas");
174 | |         let _ = fs::create_dir_all(&dir);
175 | |         dir.join("brisas_demo.db")
176 | |     } else {
177 | |         PathBuf::from("./data/brisas_demo.db")
178 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
    |
172 ~     dirs::data_local_dir().map_or_else(|| PathBuf::from("./data/brisas_demo.db"), |data_dir| {
173 +         let dir = data_dir.join("Brisas");
174 +         let _ = fs::create_dir_all(&dir);
175 +         dir.join("brisas_demo.db")
176 +     })
    |

warning: use Option::map_or_else instead of an if let/else
   --> src\config\manager.rs:183:5
    |
183 | /     if let Some(data_dir) = dirs::data_local_dir() {
184 | |         let dir = data_dir.join("Brisas").join("search_index_demo");
185 | |         let _ = fs::create_dir_all(&dir);
186 | |         dir
187 | |     } else {
188 | |         PathBuf::from("./data/search_index_demo")
189 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
    |
183 ~     dirs::data_local_dir().map_or_else(|| PathBuf::from("./data/search_index_demo"), |data_dir| {
184 +         let dir = data_dir.join("Brisas").join("search_index_demo");
185 +         let _ = fs::create_dir_all(&dir);
186 +         dir
187 +     })
    |

warning: use Option::map_or_else instead of an if let/else
   --> src\config\manager.rs:194:5
    |
194 | /     if let Some(data_dir) = dirs::data_local_dir() {
195 | |         let dir = data_dir.join("Brisas").join("search_index");
196 | |         let _ = fs::create_dir_all(&dir);
197 | |         dir
198 | |     } else {
199 | |         PathBuf::from("./data/search_index")
200 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
    |
194 ~     dirs::data_local_dir().map_or_else(|| PathBuf::from("./data/search_index"), |data_dir| {
195 +         let dir = data_dir.join("Brisas").join("search_index");
196 +         let _ = fs::create_dir_all(&dir);
197 +         dir
198 +     })
    |

warning: function call inside of `ok_or`
  --> src\db\surrealdb_alerta_queries.rs:50:13
   |
50 |     created.ok_or(SurrealDbError::Query("No se pudo crear la alerta".to_string()))
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo crear la alerta".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
   --> src\db\surrealdb_cita_queries.rs:141:37
    |
141 |     result.take::<Option<Cita>>(0)?.ok_or(SurrealDbError::Query("Error creando cita".to_string()))
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("Error creando cita".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
  --> src\db\surrealdb_contratista_queries.rs:28:17
   |
28 |         created.ok_or(SurrealDbError::Query("No se pudo crear el contratista".to_string()))?;
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo crear el contratista".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: use Option::map_or_else instead of an if let/else
  --> src\db\surrealdb_contratista_queries.rs:35:5
   |
35 | /     match fetched {
36 | |         Some(f) => Ok(f),
37 | |         None => Err(SurrealDbError::Query(
38 | |             "Contratista creado pero no se pudo obtener con FETCH".to_string(),
39 | |         )),
40 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
   |
35 ~     fetched.map_or_else(|| Err(SurrealDbError::Query(
36 +             "Contratista creado pero no se pudo obtener con FETCH".to_string(),
37 +         )), |f| Ok(f))
   |

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_contratista_queries.rs:369:5
    |
369 | /     struct NombreResult {
370 | |         nombre: String,
371 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: function call inside of `ok_or`
  --> src\db\surrealdb_empresa_queries.rs:15:12
   |
15 |     result.ok_or(SurrealDbError::Query("No se pudo crear la empresa".to_string()))
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo crear la empresa".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: adding items after statements is confusing, since items exist from the start of the scope
  --> src\db\surrealdb_empresa_queries.rs:29:5
   |
29 | /     struct IdOnly {
30 | |         id: RecordId,
31 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: function call inside of `ok_or`
  --> src\db\surrealdb_empresa_queries.rs:61:12
   |
61 |     result.ok_or(SurrealDbError::Query("No se pudo actualizar la empresa".to_string()))
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo actualizar la empresa".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: adding items after statements is confusing, since items exist from the start of the scope
  --> src\db\surrealdb_empresa_queries.rs:79:5
   |
79 | /     struct CountResult {
80 | |         count: usize,
81 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: function call inside of `ok_or`
  --> src\db\surrealdb_gafete_queries.rs:42:12
   |
42 |     result.ok_or(SurrealDbError::Query("No se pudo crear el gafete".to_string()))
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo crear el gafete".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
  --> src\db\surrealdb_gafete_queries.rs:58:12
   |
58 |     result.ok_or(SurrealDbError::Query("No se pudo actualizar el estado del gafete".to_string()))
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::Query("No se pudo actualizar el estado del gafete".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_contratista_queries.rs:32:27
   |
32 |       let ingreso = created.ok_or(SurrealDbError::TransactionError(
   |  ___________________________^
33 | |         "Error al insertar ingreso_contratista".to_string(),
34 | |     ))?;
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
32 ~     let ingreso = created.ok_or_else(|| SurrealDbError::TransactionError(
33 +         "Error al insertar ingreso_contratista".to_string(),
34 ~     ))?;
   |

warning: use Option::map_or_else instead of an if let/else
  --> src\db\surrealdb_ingreso_contratista_queries.rs:44:5
   |
44 | /     match fetched {
45 | |         Some(f) => Ok(f),
46 | |         None => Err(SurrealDbError::TransactionError(
47 | |             "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
48 | |         )),
49 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
   |
44 ~     fetched.map_or_else(|| Err(SurrealDbError::TransactionError(
45 +             "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
46 +         )), |f| Ok(f))
   |

warning: field assignment outside of initializer for an instance created with Default::default()
  --> src\db\surrealdb_ingreso_contratista_queries.rs:77:5
   |
77 |     dto.fecha_hora_salida = Some(surrealdb::Datetime::from(chrono::Utc::now()));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: consider initializing the variable with `models::ingreso::IngresoUpdateDTO { fecha_hora_salida: Some(surrealdb::Datetime::from(chrono::Utc::now())), usuario_salida: Some(usuario_salida_id.clone()), observaciones: observaciones }` and removing relevant reassignments
  --> src\db\surrealdb_ingreso_contratista_queries.rs:76:5
   |
76 |     let mut dto = IngresoContratistaUpdateDTO::default();
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default
   = note: `-W clippy::field-reassign-with-default` implied by `-W clippy::all`
   = help: to override `-W clippy::all` add `#[allow(clippy::field_reassign_with_default)]`

warning: use Option::map_or_else instead of an if let/else
   --> src\db\surrealdb_ingreso_contratista_queries.rs:97:5
    |
 97 | /     match fetched {
 98 | |         Some(f) => Ok(f),
 99 | |         None => Err(SurrealDbError::TransactionError("Error al registrar salida".to_string())),
100 | |     }
    | |_____^ help: try: `fetched.map_or_else(|| Err(SurrealDbError::TransactionError("Error al registrar salida".to_string())), |f| Ok(f))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_proveedor_queries.rs:22:27
   |
22 |       let ingreso = created.ok_or(SurrealDbError::TransactionError(
   |  ___________________________^
23 | |         "Error al insertar ingreso de proveedor".to_string(),
24 | |     ))?;
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
22 ~     let ingreso = created.ok_or_else(|| SurrealDbError::TransactionError(
23 +         "Error al insertar ingreso de proveedor".to_string(),
24 ~     ))?;
   |

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_proveedor_queries.rs:35:13
   |
35 |       fetched.ok_or(SurrealDbError::TransactionError(
   |  _____________^
36 | |         "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
37 | |     ))
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
35 ~     fetched.ok_or_else(|| SurrealDbError::TransactionError(
36 +         "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
37 +     ))
   |

warning: field assignment outside of initializer for an instance created with Default::default()
  --> src\db\surrealdb_ingreso_proveedor_queries.rs:63:5
   |
63 |     dto.fecha_hora_salida = Some(surrealdb::Datetime::from(chrono::Utc::now()));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: consider initializing the variable with `models::ingreso::IngresoUpdateDTO { fecha_hora_salida: Some(surrealdb::Datetime::from(chrono::Utc::now())), usuario_salida: Some(usuario_salida_id.clone()), observaciones: observaciones }` and removing relevant reassignments
  --> src\db\surrealdb_ingreso_proveedor_queries.rs:62:5
   |
62 |     let mut dto = IngresoUpdateDTO::default();
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_proveedor_queries.rs:82:13
   |
82 |       fetched.ok_or(SurrealDbError::TransactionError(
   |  _____________^
83 | |         "Error al registrar salida de proveedor".to_string(),
84 | |     ))
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
82 ~     fetched.ok_or_else(|| SurrealDbError::TransactionError(
83 +         "Error al registrar salida de proveedor".to_string(),
84 +     ))
   |

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_visita_queries.rs:20:27
   |
20 |       let ingreso = created.ok_or(SurrealDbError::TransactionError(
   |  ___________________________^
21 | |         "Error al insertar ingreso de visita".to_string(),
22 | |     ))?;
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
20 ~     let ingreso = created.ok_or_else(|| SurrealDbError::TransactionError(
21 +         "Error al insertar ingreso de visita".to_string(),
22 ~     ))?;
   |

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_visita_queries.rs:31:13
   |
31 |       fetched.ok_or(SurrealDbError::TransactionError(
   |  _____________^
32 | |         "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
33 | |     ))
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
31 ~     fetched.ok_or_else(|| SurrealDbError::TransactionError(
32 +         "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
33 +     ))
   |

warning: field assignment outside of initializer for an instance created with Default::default()
  --> src\db\surrealdb_ingreso_visita_queries.rs:59:5
   |
59 |     dto.fecha_hora_salida = Some(surrealdb::Datetime::from(chrono::Utc::now()));
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: consider initializing the variable with `models::ingreso::IngresoUpdateDTO { fecha_hora_salida: Some(surrealdb::Datetime::from(chrono::Utc::now())), usuario_salida: Some(usuario_salida_id.clone()), observaciones: observaciones }` and removing relevant reassignments
  --> src\db\surrealdb_ingreso_visita_queries.rs:58:5
   |
58 |     let mut dto = IngresoUpdateDTO::default();
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: function call inside of `ok_or`
  --> src\db\surrealdb_ingreso_visita_queries.rs:77:10
   |
77 |         .ok_or(SurrealDbError::TransactionError("Error al registrar salida de visita".to_string()))
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::TransactionError("Error al registrar salida de visita".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: adding items after statements is confusing, since items exist from the start of the scope
  --> src\db\surrealdb_lista_negra_queries.rs:69:5
   |
69 | /     struct LN {
70 | |         nivel_severidad: Option<String>,
71 | |         created_at: Option<Datetime>,
72 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_proveedor_queries.rs:160:5
    |
160 | /     struct NombreResult {
161 | |         nombre: String,
162 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
  --> src\db\surrealdb_role_queries.rs:40:5
   |
40 | /     struct RolePermissionsRow {
41 | |         permissions: Option<Vec<String>>,
42 | |     }
   | |_____^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_role_queries.rs:105:5
    |
105 | /     struct Count {
106 | |         count: i64,
107 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_user_queries.rs:267:5
    |
267 | /     struct CountResult {
268 | |         count: i64,
269 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_user_queries.rs:287:5
    |
287 | /     struct CountResult {
288 | |         count: i64,
289 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_user_queries.rs:300:5
    |
300 | /     struct RoleName {
301 | |         name: String,
302 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\db\surrealdb_user_queries.rs:327:5
    |
327 | /     struct AvatarPath {
328 | |         avatar_path: Option<String>,
329 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: function call inside of `ok_or`
  --> src\db\surrealdb_vehiculo_queries.rs:19:13
   |
19 |     created.ok_or(SurrealDbError::TransactionError("Error al insertar veh├¡culo".to_string()))
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| SurrealDbError::TransactionError("Error al insertar veh├¡culo".to_string()))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: use Option::map_or_else instead of an if let/else
   --> src\domain\common.rs:334:13
    |
334 | /             match chars.next() {
335 | |                 None => String::new(),
336 | |                 Some(primera) => {
337 | |                     primera.to_uppercase().collect::<String>() + &chars.as_str().to_lowercase()
338 | |                 }
339 | |             }
    | |_____________^ help: try: `chars.next().map_or_else(String::new, |primera| primera.to_uppercase().collect::<String>() + &chars.as_str().to_lowercase())`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: use Option::map_or instead of an if let/else
   --> src\domain\contratista.rs:230:5
    |
230 | /     match fecha_venc {
231 | |         Some(venc_date) => {
232 | |             let dias_hasta_vencimiento = (venc_date - hoy_date).num_days();
233 | |             let vencido = venc_date < hoy_date;
...   |
247 | |     }
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
    |
230 ~     fecha_venc.map_or(EstadoPraind { dias_hasta_vencimiento: -1, vencido: true, requiere_atencion: false }, |venc_date| {
231 +             let dias_hasta_vencimiento = (venc_date - hoy_date).num_days();
232 +             let vencido = venc_date < hoy_date;
233 +             let requiere_atencion =
234 +                 (0..=DIAS_ALERTA_VENCIMIENTO).contains(&dias_hasta_vencimiento);
235 + 
236 +             EstadoPraind { dias_hasta_vencimiento, vencido, requiere_atencion }
237 +         })
    |

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\domain\export.rs:159:29
    |
159 | pub fn validar_rows(rows: &[HashMap<String, serde_json::Value>]) -> Result<(), String> {
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
    = note: `-W clippy::implicit-hasher` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::implicit_hasher)]`
help: add a type parameter for `BuildHasher`
    |
159 | pub fn validar_rows<S: ::std::hash::BuildHasher>(rows: &[HashMap<String, serde_json::Value, S>]) -> Result<(), String> {
    |                    +++++++++++++++++++++++++++++                                          +++

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\domain\export.rs:174:13
    |
174 |     rows: &[HashMap<String, serde_json::Value>],
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
    |
172 ~ pub fn validar_consistencia_columnas<S: ::std::hash::BuildHasher>(
173 |     _headers: &[String],
174 ~     rows: &[HashMap<String, serde_json::Value, S>],
    |

warning: use Option::map_or instead of an if let/else
   --> src\domain\export.rs:272:13
    |
272 | /             if let Some(f) = n.as_f64() {
273 | |                 ExportValue::Number(f)
274 | |             } else {
275 | |                 ExportValue::Number(0.0)
276 | |             }
    | |_____________^ help: try: `n.as_f64().map_or(ExportValue::Number(0.0), |f| ExportValue::Number(f))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\domain\export.rs:301:11
    |
301 |     row: &HashMap<String, serde_json::Value>,
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
    |
300 ~ pub fn normalizar_row<S: ::std::hash::BuildHasher>(
301 ~     row: &HashMap<String, serde_json::Value, S>,
    |

warning: parameter of type `HashMap` should be generalized over different hashers
  --> src\export\csv\generator.rs:19:13
   |
19 |     rows: &[HashMap<String, ExportValue>],
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
   |
17 ~ pub fn generate_csv<S: ::std::hash::BuildHasher>(
18 |     headers: &[String],
19 ~     rows: &[HashMap<String, ExportValue, S>],
   |

warning: this function's return value is unnecessarily wrapped by `Result`
  --> src\export\csv\generator.rs:49:1
   |
49 | / fn build_csv_content(
50 | |     headers: &[String],
51 | |     rows: &[HashMap<String, ExportValue>],
52 | |     config: &CsvConfig,
53 | | ) -> ExportResult<String> {
   | |_________________________^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
   |
53 - ) -> ExportResult<String> {
53 + ) -> std::string::String {
   |
help: ...and then remove the surrounding `Ok()` from returning expressions
   |
78 -     Ok(content)
78 +     content
   |

warning: this function's return value is unnecessarily wrapped by `Result`
   --> src\export\csv\generator.rs:112:1
    |
112 | fn get_output_path(filename: &str) -> ExportResult<PathBuf> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
    |
112 - fn get_output_path(filename: &str) -> ExportResult<PathBuf> {
112 + fn get_output_path(filename: &str) -> std::path::PathBuf {
    |
help: ...and then remove the surrounding `Ok()` from returning expressions
    |
116 ~         return path;
117 |     }
...
120 |     let temp_dir = std::env::temp_dir();
121 ~     temp_dir.join(filename)
    |

warning: parameter of type `HashMap` should be generalized over different hashers
  --> src\export\pdf\engine.rs:30:13
   |
30 |     rows: &[HashMap<String, ExportValue>],
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
   |
28 ~ pub fn generate_pdf<S: ::std::hash::BuildHasher>(
29 |     headers: &[String],
30 ~     rows: &[HashMap<String, ExportValue, S>],
   |

warning: this function's return value is unnecessarily wrapped by `Result`
  --> src\export\pdf\engine.rs:87:5
   |
87 |     fn new(markup: &str) -> ExportResult<Self> {
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
   |
87 -     fn new(markup: &str) -> ExportResult<Self> {
87 +     fn new(markup: &str) -> export::pdf::engine::TypstWorld {
   |
help: ...and then remove the surrounding `Ok()` from returning expressions
   |
99 -         Ok(Self { library, book, fonts, source, main_id, packages_root })
99 +         Self { library, book, fonts, source, main_id, packages_root }
   |

warning: casting `u32` to `u8` may truncate the value
   --> src\export\pdf\engine.rs:300:40
    |
300 |         Datetime::from_ymd(now.year(), now.month() as u8, now.day() as u8)
    |                                        ^^^^^^^^^^^^^^^^^
    |
    = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
    |
300 -         Datetime::from_ymd(now.year(), now.month() as u8, now.day() as u8)
300 +         Datetime::from_ymd(now.year(), u8::try_from(now.month()), now.day() as u8)
    |

warning: casting `u32` to `u8` may truncate the value
   --> src\export\pdf\engine.rs:300:59
    |
300 |         Datetime::from_ymd(now.year(), now.month() as u8, now.day() as u8)
    |                                                           ^^^^^^^^^^^^^^^
    |
    = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
    |
300 -         Datetime::from_ymd(now.year(), now.month() as u8, now.day() as u8)
300 +         Datetime::from_ymd(now.year(), now.month() as u8, u8::try_from(now.day()))
    |

warning: this function's return value is unnecessarily wrapped by `Result`
  --> src\export\pdf\templates.rs:46:1
   |
46 | fn generate_page_setup(config: &PdfConfig, design: &PdfDesign) -> ExportResult<String> {
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
   |
46 - fn generate_page_setup(config: &PdfConfig, design: &PdfDesign) -> ExportResult<String> {
46 + fn generate_page_setup(config: &PdfConfig, design: &PdfDesign) -> std::string::String {
   |
help: ...and then remove the surrounding `Ok()` from returning expressions
   |
80 -     Ok(setup)
80 +     setup
   |

warning: this function's return value is unnecessarily wrapped by `Result`
   --> src\export\pdf\templates.rs:148:1
    |
148 | / fn generate_table(
149 | |     headers: &[String],
150 | |     rows: &[HashMap<String, ExportValue>],
151 | |     config: &PdfConfig,
152 | | ) -> ExportResult<String> {
    | |_________________________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
    |
152 - ) -> ExportResult<String> {
152 + ) -> std::string::String {
    |
help: ...and then remove the surrounding `Ok()` from returning expressions
    |
250 -     Ok(markup)
250 +     markup
    |

warning: this `if` has identical blocks
   --> src\export\pdf\templates.rs:166:13
    |
166 | /             {
167 | |                 "1.3fr" // Texto largo principal - Reducido levemente
168 | |             } else if lower.contains("guarda") // GuardaE, GuardaS
    | |_____________^
    |
note: same as this
   --> src\export\pdf\templates.rs:171:13
    |
171 | /             {
172 | |                 "1.3fr" // Nombres de usuario (Daniel, etc.)
173 | |             } else if lower.contains("modo") {
    | |_____________^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#if_same_then_else
    = note: `-W clippy::if-same-then-else` implied by `-W clippy::all`
    = help: to override `-W clippy::all` add `#[allow(clippy::if_same_then_else)]`

warning: this `if` has identical blocks
   --> src\export\pdf\templates.rs:173:46
    |
173 |               } else if lower.contains("modo") {
    |  ______________________________________________^
174 | |                 "1.2fr" // "Caminando" ocupa espacio
175 | |             } else if lower.contains("c├®dula")
    | |_____________^
    |
note: same as this
   --> src\export\pdf\templates.rs:179:13
    |
179 | /             {
180 | |                 "1.2fr" // Identificadores medianos
181 | |             } else if lower.contains("gafete")
    | |_____________^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#if_same_then_else

warning: this `if` has identical blocks
   --> src\export\pdf\templates.rs:185:13
    |
185 | /             {
186 | |                 "0.9fr" // Identificadores cortos
187 | |             } else if lower.contains("fecha")
    | |_____________^
    |
note: same as this
   --> src\export\pdf\templates.rs:191:13
    |
191 | /             {
192 | |                 "0.9fr" // Fechas/Horas
193 | |             } else if lower == "id" || lower == "#" || lower == "no" {
    | |_____________^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#if_same_then_else

warning: `format!(..)` appended to existing `String`
   --> src\export\pdf\templates.rs:217:9
    |
217 | /         markup.push_str(&format!(
218 | |             "    [#set par(justify: false); *#text(fill: rgb(\"#1f2328\"), size: {header_size}, hyphenate: true)[{escaped_header}]*],\n"
219 | |         ));
    | |__________^
    |
    = help: consider using `write!` to avoid the extra allocation
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#format_push_string
    = note: `-W clippy::format-push-string` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::format_push_string)]`

warning: `format!(..)` appended to existing `String`
   --> src\export\pdf\templates.rs:242:13
    |
242 | /             markup.push_str(&format!(
243 | |                 "    [#set par(justify: false); #text(fill: rgb(\"#1f2328\"), size: {body_size}, hyphenate: true)[{escaped_value}]],\n"
244 | |             ));
    | |______________^
    |
    = help: consider using `write!` to avoid the extra allocation
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#format_push_string

warning: parameter of type `HashMap` should be generalized over different hashers
  --> src\export\excel\builder.rs:20:13
   |
20 |     rows: &[HashMap<String, ExportValue>],
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
   |
18 ~ pub fn generate_excel<S: ::std::hash::BuildHasher>(
19 |     headers: &[String],
20 ~     rows: &[HashMap<String, ExportValue, S>],
   |

warning: casting `usize` to `u16` may truncate the value
  --> src\export\excel\builder.rs:66:42
   |
66 |             .write_string_with_format(0, col_idx as u16, header, &header_format)
   |                                          ^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
66 -             .write_string_with_format(0, col_idx as u16, header, &header_format)
66 +             .write_string_with_format(0, u16::try_from(col_idx), header, &header_format)
   |

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\export\excel\builder.rs:77:21
   |
77 |                     (row_idx + 1) as u32,
   |                     ^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
77 -                     (row_idx + 1) as u32,
77 +                     u32::try_from(row_idx + 1),
   |

warning: casting `usize` to `u16` may truncate the value
  --> src\export\excel\builder.rs:78:21
   |
78 |                     col_idx as u16,
   |                     ^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
78 -                     col_idx as u16,
78 +                     u16::try_from(col_idx),
   |

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\export\excel\builder.rs:83:21
   |
83 |                     (row_idx + 1) as u32,
   |                     ^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
83 -                     (row_idx + 1) as u32,
83 +                     u32::try_from(row_idx + 1),
   |

warning: casting `usize` to `u16` may truncate the value
  --> src\export\excel\builder.rs:84:21
   |
84 |                     col_idx as u16,
   |                     ^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
84 -                     col_idx as u16,
84 +                     u16::try_from(col_idx),
   |

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\export\excel\builder.rs:89:21
   |
89 |                     (row_idx + 1) as u32,
   |                     ^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
89 -                     (row_idx + 1) as u32,
89 +                     u32::try_from(row_idx + 1),
   |

warning: casting `usize` to `u16` may truncate the value
  --> src\export\excel\builder.rs:90:21
   |
90 |                     col_idx as u16,
   |                     ^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
90 -                     col_idx as u16,
90 +                     u16::try_from(col_idx),
   |

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\export\excel\builder.rs:95:21
   |
95 |                     (row_idx + 1) as u32,
   |                     ^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
95 -                     (row_idx + 1) as u32,
95 +                     u32::try_from(row_idx + 1),
   |

warning: casting `usize` to `u16` may truncate the value
  --> src\export\excel\builder.rs:96:21
   |
96 |                     col_idx as u16,
   |                     ^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
96 -                     col_idx as u16,
96 +                     u16::try_from(col_idx),
   |

warning: this function's return value is unnecessarily wrapped by `Result`
   --> src\export\excel\builder.rs:129:1
    |
129 | fn create_header_format() -> ExportResult<Format> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
    |
129 - fn create_header_format() -> ExportResult<Format> {
129 + fn create_header_format() -> rust_xlsxwriter::Format {
    |
help: ...and then remove the surrounding `Ok()` from returning expressions
    |
138 -     Ok(format)
138 +     format
    |

warning: this function's return value is unnecessarily wrapped by `Result`
   --> src\export\excel\builder.rs:142:1
    |
142 | fn create_cell_format() -> ExportResult<Format> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_wraps
help: remove `Result` from the return type...
    |
142 - fn create_cell_format() -> ExportResult<Format> {
142 + fn create_cell_format() -> rust_xlsxwriter::Format {
    |
help: ...and then remove the surrounding `Ok()` from returning expressions
    |
148 -     Ok(format)
148 +     format
    |

warning: casting `usize` to `u16` may truncate the value
   --> src\export\excel\builder.rs:170:36
    |
170 |         worksheet.set_column_width(col_idx as u16, width).map_err(|e| {
    |                                    ^^^^^^^^^^^^^^
    |
    = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
    |
170 -         worksheet.set_column_width(col_idx as u16, width).map_err(|e| {
170 +         worksheet.set_column_width(u16::try_from(col_idx), width).map_err(|e| {
    |

warning: casting `usize` to `f64` causes a loss of precision on targets with 64-bit wide pointers (`usize` is 64 bits wide, but `f64`'s mantissa is only 52 bits wide)
   --> src\export\excel\builder.rs:196:5
    |
196 |     (max_len as f64) * 1.2
    |     ^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_precision_loss
    = note: `-W clippy::cast-precision-loss` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::cast_precision_loss)]`

warning: more than 3 bools in a struct
   --> src\models\contratista.rs:284:1
    |
284 | / pub struct ContratistaResponse {
285 | |     pub id: String,
286 | |     pub cedula: String,
287 | |     pub nombre: String,
...   |
308 | |     pub deleted_at: Option<String>,
309 | | }
    | |_^
    |
    = help: consider using a state machine or refactoring bools into two-variant enums
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#struct_excessive_bools
    = note: `-W clippy::struct-excessive-bools` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::struct_excessive_bools)]`

warning: more than 3 bools in a struct
   --> src\models\role.rs:339:1
    |
339 | / pub struct VisibleModule {
340 | |     pub module: String,
341 | |     pub display_name: String,
342 | |     pub can_create: bool,
...   |
346 | |     pub can_export: bool,
347 | | }
    | |_^
    |
    = help: consider using a state machine or refactoring bools into two-variant enums
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#struct_excessive_bools

warning: use Option::map_or_else instead of an if let/else
   --> src\models\user.rs:283:36
    |
283 |           let (role_id, role_name) = match &u.role {
    |  ____________________________________^
284 | |             Some(role) => (role.id.to_string(), role.name.clone()),
285 | |             None => ("unknown".to_string(), "Sin Rol".to_string()),
286 | |         };
    | |_________^ help: try: `u.role.as_ref().map_or_else(|| ("unknown".to_string(), "Sin Rol".to_string()), |role| (role.id.to_string(), role.name.clone()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: function call inside of `ok_or`
  --> src\repositories\ingreso_contratista.rs:25:31
   |
25 |           let ingreso = created.ok_or(SurrealDbError::TransactionError(
   |  _______________________________^
26 | |             "Error al insertar ingreso_contratista".to_string(),
27 | |         ))?;
   | |__________^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
25 ~         let ingreso = created.ok_or_else(|| SurrealDbError::TransactionError(
26 +             "Error al insertar ingreso_contratista".to_string(),
27 ~         ))?;
   |

warning: use Option::map_or_else instead of an if let/else
  --> src\repositories\ingreso_contratista.rs:37:9
   |
37 | /         match fetched {
38 | |             Some(f) => Ok(f),
39 | |             None => Err(SurrealDbError::TransactionError(
40 | |                 "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
41 | |             )),
42 | |         }
   | |_________^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
   |
37 ~         fetched.map_or_else(|| Err(SurrealDbError::TransactionError(
38 +                 "Ingreso creado pero no se pudo obtener con FETCH".to_string(),
39 +             )), |f| Ok(f))
   |

warning: field assignment outside of initializer for an instance created with Default::default()
  --> src\repositories\ingreso_contratista.rs:70:9
   |
70 |         dto.fecha_hora_salida = Some(surrealdb::Datetime::from(chrono::Utc::now()));
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: consider initializing the variable with `models::ingreso::IngresoUpdateDTO { fecha_hora_salida: Some(surrealdb::Datetime::from(chrono::Utc::now())), usuario_salida: Some(usuario_salida_id.clone()), observaciones: observaciones }` and removing relevant reassignments
  --> src\repositories\ingreso_contratista.rs:69:9
   |
69 |         let mut dto = crate::models::ingreso::IngresoContratistaUpdateDTO::default();
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: use Option::map_or_else instead of an if let/else
  --> src\repositories\ingreso_contratista.rs:90:9
   |
90 | /         match fetched {
91 | |             Some(f) => Ok(f),
92 | |             None => Err(SurrealDbError::TransactionError("Error al registrar salida".to_string())),
93 | |         }
   | |_________^ help: try: `fetched.map_or_else(|| Err(SurrealDbError::TransactionError("Error al registrar salida".to_string())), |f| Ok(f))`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else

warning: function call inside of `ok_or`
  --> src\search\connection.rs:14:46
   |
14 |       let index_path = index_path_buf.to_str().ok_or(SearchError::InitializationError(
   |  ______________________________________________^
15 | |         "Ruta de ├¡ndice inv├ílida (no UTF-8)".to_string(),
16 | |     ))?;
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
14 ~     let index_path = index_path_buf.to_str().ok_or_else(|| SearchError::InitializationError(
15 ~         "Ruta de ├¡ndice inv├ílida (no UTF-8)".to_string(),
16 ~     ))?;
   |

warning: unnecessary `Debug` formatting in `info!` args
  --> src\search\indexer.rs:58:44
   |
58 |         info!("­ƒôé Creando nuevo ├¡ndice en: {index_path:?}");
   |                                             ^^^^^^^^^^
   |
   = help: use `Display` formatting and change this to `index_path.display()`
   = note: switching to `Display` formatting will change how the value is shown; escaped characters will no longer be escaped and surrounding quotes will be removed
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_debug_formatting
   = note: `-W clippy::unnecessary-debug-formatting` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::unnecessary_debug_formatting)]`

warning: `if _ { .. } else { .. }` is an expression
   --> src\search\searcher.rs:175:5
    |
175 | /     let mut nombre_completo = format!("{nombre} {apellido}");
176 | |
177 | |     if let Some(segundo_nombre) = get_val(doc, fields.segundo_nombre) {
178 | |         nombre_completo = format!("{nombre} {segundo_nombre} {apellido}");
179 | |     }
    | |_____^
    |
    = note: you might not need `mut` at all
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#useless_let_if_seq
    = note: `-W clippy::useless-let-if-seq` implied by `-W clippy::nursery`
    = help: to override `-W clippy::nursery` add `#[allow(clippy::useless_let_if_seq)]`
help: it is more idiomatic to write
    |
175 ~     let <mut> nombre_completo = if let Some(segundo_nombre) = get_val(doc, fields.segundo_nombre) { $crate::__export::must_use({
176 +             $crate::fmt::format($crate::__export::format_args!($($arg)*))
177 +         }) } else { $crate::__export::must_use({
178 +             $crate::fmt::format($crate::__export::format_args!($($arg)*))
179 +         }) };
    |

warning: assigning the result of `Clone::clone()` may be inefficient
  --> src\services\contratista_service.rs:71:13
   |
71 |             response.vehiculo_marca = v.marca.clone();
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_marca.clone_from(&v.marca)`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones
   = note: `-W clippy::assigning-clones` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::assigning_clones)]`

warning: assigning the result of `Clone::clone()` may be inefficient
  --> src\services\contratista_service.rs:72:13
   |
72 |             response.vehiculo_modelo = v.modelo.clone();
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_modelo.clone_from(&v.modelo)`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: assigning the result of `Clone::clone()` may be inefficient
  --> src\services\contratista_service.rs:73:13
   |
73 |             response.vehiculo_color = v.color.clone();
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_color.clone_from(&v.color)`
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\services\contratista_service.rs:288:21
    |
288 |                     use crate::db::surrealdb_vehiculo_queries as veh_db_direct;
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: this argument is passed by value, but not consumed in the function body
   --> src\services\contratista_service.rs:456:20
    |
456 | fn map_db_error(e: SurrealDbError) -> ContratistaError {
    |                    ^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
    |
456 | fn map_db_error(e: &SurrealDbError) -> ContratistaError {
    |                    +

warning: casting `usize` to `i64` may wrap around the value on targets with 64-bit wide pointers
   --> src\services\empresa_service.rs:173:50
    |
173 |         return Err(EmpresaError::HasContratistas(count as i64));
    |                                                  ^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_wrap
    = note: `-W clippy::cast-possible-wrap` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::cast_possible_wrap)]`

warning: this argument is passed by value, but not consumed in the function body
   --> src\services\empresa_service.rs:187:20
    |
187 | fn map_db_error(e: SurrealDbError) -> EmpresaError {
    |                    ^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
    |
187 | fn map_db_error(e: &SurrealDbError) -> EmpresaError {
    |                    +

warning: function call inside of `ok_or`
  --> src\services\export_profile_service.rs:23:35
   |
23 |       let parent = db_path.parent().ok_or(ExportError::FileSystemError(
   |  ___________________________________^
24 | |         "No se pudo localizar el directorio de configuraci├│n del sistema.".to_string(),
25 | |     ))?;
   | |______^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
23 ~     let parent = db_path.parent().ok_or_else(|| ExportError::FileSystemError(
24 ~         "No se pudo localizar el directorio de configuraci├│n del sistema.".to_string(),
25 ~     ))?;
   |

warning: writing `&mut Vec` instead of `&mut [_]` involves a new object where a slice will do
   --> src\services\export_profile_service.rs:196:15
    |
196 |     profiles: &mut Vec<ExportProfile>,
    |               ^^^^^^^^^^^^^^^^^^^^^^^ help: change this to: `&mut [ExportProfile]`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#ptr_arg
    = note: `-W clippy::ptr-arg` implied by `-W clippy::all`
    = help: to override `-W clippy::all` add `#[allow(clippy::ptr_arg)]`

warning: this argument is passed by value, but not consumed in the function body
   --> src\services\export_profile_service.rs:248:27
    |
248 | pub fn delete_profile(id: String) -> Result<(), ExportError> {
    |                           ^^^^^^ help: consider changing the type to: `&str`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value

warning: this argument is passed by value, but not consumed in the function body
   --> src\services\export_profile_service.rs:268:32
    |
268 | pub fn set_default_profile(id: String) -> Result<(), ExportError> {
    |                                ^^^^^^ help: consider changing the type to: `&str`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value

warning: use Option::map_or_else instead of an if let/else
   --> src\services\export_service.rs:220:19
    |
220 |       let profile = if let Some(ref id) = config.template_id {
    |  ___________________^
221 | |         export_profile_service::get_profile_by_id(id)
222 | |             .or_else(export_profile_service::get_default_profile)
223 | |     } else {
224 | |         export_profile_service::get_default_profile()
225 | |     };
    | |_____^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#option_if_let_else
help: try
    |
220 ~     let profile = config.template_id.as_ref().map_or_else(export_profile_service::get_default_profile, |id| export_profile_service::get_profile_by_id(id)
221 ~             .or_else(export_profile_service::get_default_profile));
    |

warning: redundant pattern matching, consider using `is_ok()`
   --> src\services\gafete_service.rs:174:16
    |
174 |         if let Ok(_) = db::create_gafete(dto).await {
    |         -------^^^^^------------------------------- help: try: `if (db::create_gafete(dto).await).is_ok()`
    |
    = note: this will change drop order of the result, as well as all temporaries
    = note: add `#[allow(clippy::redundant_pattern_matching)]` if this is important
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#redundant_pattern_matching
    = note: `-W clippy::redundant-pattern-matching` implied by `-W clippy::all`
    = help: to override `-W clippy::all` add `#[allow(clippy::redundant_pattern_matching)]`

warning: adding items after statements is confusing, since items exist from the start of the scope
   --> src\services\role_service.rs:225:5
    |
225 |     use crate::services::surrealdb_authorization;
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#items_after_statements

warning: casting `usize` to `u32` may truncate the value on targets with 64-bit wide pointers
  --> src\services\keyring_windows.rs:52:29
   |
52 |         CredentialBlobSize: value_bytes.len() as u32,
   |                             ^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: if this is intentional allow the lint with `#[allow(clippy::cast_possible_truncation)]` ...
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#cast_possible_truncation
help: ... or use `try_from` and handle the error accordingly
   |
52 -         CredentialBlobSize: value_bytes.len() as u32,
52 +         CredentialBlobSize: u32::try_from(value_bytes.len()),
   |

warning: function call inside of `ok_or`
  --> src\services\cita_service.rs:92:10
   |
92 |           .ok_or(CitaError::Database(
   |  __________^
93 | |             "Fallo cr├¡tico al recuperar la cita reci├®n creada".to_string(),
94 | |         ))?;
   | |__________^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
   |
92 ~         .ok_or_else(|| CitaError::Database(
93 ~             "Fallo cr├¡tico al recuperar la cita reci├®n creada".to_string(),
94 ~         ))?;
   |

warning: function call inside of `ok_or`
   --> src\services\cita_service.rs:239:10
    |
239 |           .ok_or(CitaError::Database(
    |  __________^
240 | |             "Fallo al actualizar el estado de la cita a 'completada'".to_string(),
241 | |         ))?;
    | |__________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call
help: try
    |
239 ~         .ok_or_else(|| CitaError::Database(
240 +             "Fallo al actualizar el estado de la cita a 'completada'".to_string(),
241 ~         ))?;
    |

warning: function call inside of `ok_or`
   --> src\services\cita_service.rs:275:14
    |
275 |             .ok_or(CitaError::Validation("Fecha con formato incompleto".to_string()))?;
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| CitaError::Validation("Fecha con formato incompleto".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: all fields have the same postfix: `repo`
  --> src\services\ingreso_contratista_service.rs:29:1
   |
29 | / pub struct IngresoContratistaService<
30 | |     R: IngresoContratistaRepository,
31 | |     G: GafeteRepository,
32 | |     C: ContratistaRepository,
...  |
38 | |     security_repo: S,
39 | | }
   | |_^
   |
   = help: remove the postfixes
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#struct_field_names
   = note: `-W clippy::struct-field-names` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::struct_field_names)]`

warning: this could be rewritten as `let...else`
   --> src\services\ingreso_general_service.rs:125:5
    |
125 | /     let ingreso = match db::find_by_id_fetched(&id)
126 | |         .await
127 | |         .map_err(|e| IngresoError::Database(e.to_string()))?
...   |
130 | |         None => return Ok(None),
131 | |     };
    | |______^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#manual_let_else
    = note: `-W clippy::manual-let-else` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::manual_let_else)]`
help: consider writing
    |
125 ~     let Some(ingreso) = db::find_by_id_fetched(&id)
126 +         .await
127 +         .map_err(|e| IngresoError::Database(e.to_string()))? else { return Ok(None) };
    |

warning: this could be rewritten as `let...else`
   --> src\services\ingreso_general_service.rs:150:5
    |
150 | /     let ingreso = if let Some(i) = db::find_ingreso_by_gafete_fetched(gafete_numero).await.map_err(|e| {
151 | |         error!("Error buscando ingreso por gafete {gafete_numero}: {e}");
152 | |         IngresoError::Database(e.to_string())
153 | |     })? { i } else {
154 | |         info!("No se encontr├│ ingreso activo para el gafete {gafete_numero}");
155 | |         return Ok(None);
156 | |     };
    | |______^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#manual_let_else
help: consider writing
    |
150 ~     let Some(ingreso) = db::find_ingreso_by_gafete_fetched(gafete_numero).await.map_err(|e| {
151 +         error!("Error buscando ingreso por gafete {gafete_numero}: {e}");
152 +         IngresoError::Database(e.to_string())
153 +     })? else {
154 ~         info!("No se encontr├│ ingreso activo para el gafete {gafete_numero}");
155 +         return Ok(None);
156 +     };
    |

warning: function call inside of `ok_or`
   --> src\services\ingreso_proveedor_service.rs:119:10
    |
119 |         .ok_or(IngresoProveedorError::Validation("Proveedor no encontrado".to_string()))?;
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `ok_or_else(|| IngresoProveedorError::Validation("Proveedor no encontrado".to_string()))`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#or_fun_call

warning: field assignment outside of initializer for an instance created with Default::default()
   --> src\services\proveedor_service.rs:194:5
    |
194 |     dto.estado = Some(new_status.parse::<EstadoProveedor>().map_err(ProveedorError::Validation)?);
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
note: consider initializing the variable with `models::proveedor::ProveedorUpdateDTO { estado: Some(new_status.parse::<EstadoProveedor>().map_err(ProveedorError::Validation)?), updated_at: Some(surrealdb::Datetime::from(Utc::now())), ..Default::default() }` and removing relevant reassignments
   --> src\services\proveedor_service.rs:193:5
    |
193 |     let mut dto = ProveedorUpdateDTO::default();
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:225:9
    |
225 |         response.vehiculo_marca = v.marca.clone();
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_marca.clone_from(&v.marca)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:226:9
    |
226 |         response.vehiculo_modelo = v.modelo.clone();
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_modelo.clone_from(&v.modelo)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:227:9
    |
227 |         response.vehiculo_color = v.color.clone();
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `response.vehiculo_color.clone_from(&v.color)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: field assignment outside of initializer for an instance created with Default::default()
   --> src\services\proveedor_service.rs:308:25
    |
308 | /                         veh_dto.tipo_vehiculo = Some(
309 | |                             tipo_norm
310 | |                                 .parse::<crate::models::vehiculo::TipoVehiculo>()
311 | |                                 .map_err(ProveedorError::Validation)?,
312 | |                         );
    | |__________________________^
    |
note: consider initializing the variable with `models::vehiculo::VehiculoUpdateDTO { tipo_vehiculo: Some(
                                  tipo_norm
                                      .parse::<crate::models::vehiculo::TipoVehiculo>()
                                      .map_err(ProveedorError::Validation)?,
                              ), marca: input.marca.clone(), modelo: input.modelo.clone(), color: input.color.clone(), is_active: Some(true), updated_at: Some(surrealdb::Datetime::from(Utc::now())) }` and removing relevant reassignments
   --> src\services\proveedor_service.rs:307:25
    |
307 |                         let mut veh_dto = crate::models::vehiculo::VehiculoUpdateDTO::default();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:313:25
    |
313 |                         veh_dto.marca = input.marca.clone();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `veh_dto.marca.clone_from(&input.marca)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:314:25
    |
314 |                         veh_dto.modelo = input.modelo.clone();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `veh_dto.modelo.clone_from(&input.modelo)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: assigning the result of `Clone::clone()` may be inefficient
   --> src\services\proveedor_service.rs:315:25
    |
315 |                         veh_dto.color = input.color.clone();
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `clone_from()`: `veh_dto.color.clone_from(&input.color)`
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#assigning_clones

warning: this function has too many lines (109/100)
   --> src\services\user_service.rs:268:1
    |
268 | / pub async fn update_user(
269 | |     search_service: &Arc<SearchService>,
270 | |     id_str: String,
271 | |     input: UpdateUserInput,
272 | | ) -> Result<UserResponse, UserError> {
    | |____________________________________^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#too_many_lines

warning: this argument is passed by value, but not consumed in the function body
  --> src\services\vehiculo_service.rs:32:20
   |
32 | fn map_db_error(e: SurrealDbError) -> VehiculoError {
   |                    ^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
   |
32 | fn map_db_error(e: &SurrealDbError) -> VehiculoError {
   |                    +

warning: this argument is passed by value, but not consumed in the function body
  --> src\services\visitante_service.rs:39:20
   |
39 | fn map_db_error(e: SurrealDbError) -> VisitanteError {
   |                    ^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#needless_pass_by_value
help: consider taking a reference instead
   |
39 | fn map_db_error(e: &SurrealDbError) -> VisitanteError {
   |                    +

warning: field assignment outside of initializer for an instance created with Default::default()
   --> src\services\visitante_service.rs:237:5
    |
237 |     dto.nombre = Some(input.nombre);
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
note: consider initializing the variable with `models::visitante::VisitanteUpdateDTO { nombre: Some(input.nombre), apellido: Some(input.apellido), segundo_nombre: Some(input.segundo_nombre), segundo_apellido: Some(input.segundo_apellido), empresa: Some(parse_record_id(&input.empresa_id, "empresa")), has_vehicle: Some(input.has_vehicle), updated_at: Some(surrealdb::Datetime::from(Utc::now())) }` and removing relevant reassignments
   --> src\services\visitante_service.rs:236:5
    |
236 |     let mut dto = VisitanteUpdateDTO::default();
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: unnecessary `Debug` formatting in `debug!` args
   --> src\services\surrealdb_service.rs:130:41
    |
130 |         debug!("­ƒôé Ruta de datos: {:?}", self.config.data_path);
    |                                          ^^^^^^^^^^^^^^^^^^^^^
    |
    = help: use `Display` formatting and change this to `self.config.data_path.display()`
    = note: switching to `Display` formatting will change how the value is shown; escaped characters will no longer be escaped and surrounding quotes will be removed
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unnecessary_debug_formatting

warning: very complex type used. Consider factoring parts into `type` definitions
  --> src\services\cache_service.rs:59:31
   |
59 | pub static CONTRATISTA_CACHE: Lazy<Arc<RwLock<HashMap<String, CacheEntry<ContratistaFetched>>>>> =
   |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#type_complexity
   = note: `-W clippy::type-complexity` implied by `-W clippy::all`
   = help: to override `-W clippy::all` add `#[allow(clippy::type_complexity)]`

warning: very complex type used. Consider factoring parts into `type` definitions
  --> src\services\cache_service.rs:63:29
   |
63 | pub static PROVEEDOR_CACHE: Lazy<Arc<RwLock<HashMap<String, CacheEntry<ProveedorFetched>>>>> =
   |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#type_complexity

warning: parameter of type `HashMap` should be generalized over different hashers
  --> src\services\cache_service.rs:79:20
   |
79 |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
   |
78 ~ pub async fn get_cached<T: Clone, S: ::std::hash::BuildHasher>(
79 ~     cache: &RwLock<HashMap<String, CacheEntry<T>, S>>,
   |

warning: future cannot be sent between threads safely
  --> src\services\cache_service.rs:78:1
   |
78 | / pub async fn get_cached<T: Clone>(
79 | |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
80 | |     key: &str,
81 | | ) -> Option<T> {
   | |______________^
   |
   = note: `T` doesn't implement `std::marker::Send`
   = note: `T` doesn't implement `std::marker::Sync`
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#future_not_send
   = note: `-W clippy::future-not-send` implied by `-W clippy::nursery`
   = help: to override `-W clippy::nursery` add `#[allow(clippy::future_not_send)]`

warning: temporary with significant `Drop` can be early dropped
  --> src\services\cache_service.rs:82:9
   |
81 |   ) -> Option<T> {
   |  ________________-
82 | |     let guard = cache.read().await;
   | |         ^^^^^
83 | |     if let Some(entry) = guard.get(key) {
84 | |         if !entry.is_expired() {
...  |
88 | |     None
89 | | }
   | |_- temporary `guard` is currently being dropped at the end of its contained scope
   |
   = note: this might lead to unnecessary resource contention
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#significant_drop_tightening
help: merge the temporary construction with its single usage
   |
82 ~     
83 +     cache.read().await.;
84 ~     
   |

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\services\cache_service.rs:102:20
    |
102 |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
    |
101 ~ pub async fn set_cached<T: Clone, S: ::std::hash::BuildHasher>(
102 ~     cache: &RwLock<HashMap<String, CacheEntry<T>, S>>,
    |

warning: future cannot be sent between threads safely
   --> src\services\cache_service.rs:101:1
    |
101 | / pub async fn set_cached<T: Clone>(
102 | |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
103 | |     key: String,
104 | |     data: T,
105 | |     ttl_secs: u64,
106 | | ) {
    | |_^ future returned by `set_cached` is not `Send`
    |
note: future is not `Send` as this value is used across an await
   --> src\services\cache_service.rs:107:35
    |
104 |     data: T,
    |     ---- has type `T` which is not `Send`
...
107 |     let mut guard = cache.write().await;
    |                                   ^^^^^ await occurs here, with `data` maybe used later
    = note: `T` doesn't implement `std::marker::Send`
    = note: `T` doesn't implement `std::marker::Sync`
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#future_not_send

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\services\cache_service.rs:122:20
    |
122 |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
    |
121 ~ pub async fn invalidate_cached<T: Clone, S: ::std::hash::BuildHasher>(
122 ~     cache: &RwLock<HashMap<String, CacheEntry<T>, S>>,
    |

warning: future cannot be sent between threads safely
   --> src\services\cache_service.rs:121:1
    |
121 | / pub async fn invalidate_cached<T: Clone>(
122 | |     cache: &RwLock<HashMap<String, CacheEntry<T>>>,
123 | |     key: &str,
124 | | ) {
    | |_^
    |
    = note: `T` doesn't implement `std::marker::Send`
    = note: `T` doesn't implement `std::marker::Sync`
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#future_not_send

warning: parameter of type `HashMap` should be generalized over different hashers
   --> src\services\cache_service.rs:136:51
    |
136 | pub async fn clear_cache<T: Clone>(cache: &RwLock<HashMap<String, CacheEntry<T>>>) {
    |                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#implicit_hasher
help: add a type parameter for `BuildHasher`
    |
136 | pub async fn clear_cache<T: Clone, S: ::std::hash::BuildHasher>(cache: &RwLock<HashMap<String, CacheEntry<T>, S>>) {
    |                                  +++++++++++++++++++++++++++++                                              +++

warning: future cannot be sent between threads safely
   --> src\services\cache_service.rs:136:1
    |
136 | pub async fn clear_cache<T: Clone>(cache: &RwLock<HashMap<String, CacheEntry<T>>>) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = note: `T` doesn't implement `std::marker::Send`
    = note: `T` doesn't implement `std::marker::Sync`
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#future_not_send

warning: field assignment outside of initializer for an instance created with Default::default()
  --> src\lib.rs:79:13
   |
79 |             db_config.data_path = config_manager::get_database_path(&app_config);
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
note: consider initializing the variable with `services::surrealdb_service::SurrealDbConfig { data_path: config_manager::get_database_path(&app_config), ..Default::default() }` and removing relevant reassignments
  --> src\lib.rs:78:13
   |
78 |             let mut db_config = SurrealDbConfig::default();
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#field_reassign_with_default

warning: unused `async` for function with no await statements
   --> src\commands\audio_commands.rs:95:1
    |
 95 | / pub async fn play_sound(
 96 | |     _sound: String,
 97 | |     _custom_path: Option<String>,
 98 | |     _use_custom: bool,
 99 | | ) -> Result<(), String> {
100 | |     Ok(())
101 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async
    = note: `-W clippy::unused-async` implied by `-W clippy::pedantic`
    = help: to override `-W clippy::pedantic` add `#[allow(clippy::unused_async)]`

warning: unused `async` for function with no await statements
   --> src\services\export_service.rs:319:1
    |
319 | / async fn export_to_csv_internal(data: ExportData) -> ExportResult<ExportResponse> {
320 | |     use crate::export::csv;
321 | |
322 | |     let config = data
...   |
335 | |     })
336 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\role_service.rs:257:1
    |
257 | / pub async fn get_all_permissions() -> Result<Vec<Permission>, RoleError> {
258 | |     let mut perms = Vec::new();
259 | |
260 | |     for module in Module::all() {
...   |
273 | |     Ok(perms)
274 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\ingreso_contratista_service.rs:215:5
    |
215 | /     pub async fn validar_puede_salir(
216 | |         &self,
217 | |         _ingreso_id: &str,
218 | |         _gafete: Option<&str>,
219 | |     ) -> Result<ResultadoValidacionSalida, String> {
220 | |         Ok(ResultadoValidacionSalida { puede_salir: true, errores: vec![], advertencias: vec![] })
221 | |     }
    | |_____^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\ingreso_contratista_service.rs:223:5
    |
223 | /     pub async fn get_ingresos_abiertos_con_alertas(
224 | |         &self,
225 | |     ) -> Result<Vec<IngresoConEstadoResponse>, IngresoContratistaError> {
226 | |         Ok(vec![])
227 | |     }
    | |_____^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\ingreso_contratista_service.rs:229:5
    |
229 | /     pub async fn verificar_tiempos_excedidos(
230 | |         &self,
231 | |     ) -> Result<Vec<AlertaTiempoExcedido>, IngresoContratistaError> {
232 | |         Ok(vec![])
233 | |     }
    | |_____^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\ingreso_proveedor_service.rs:220:1
    |
220 | / pub async fn get_activos() -> Result<Vec<IngresoResponse>, IngresoProveedorError> {
221 | |     // TODO: Implementar query real. Por ahora placeholder seguro.
222 | |     Ok(vec![])
223 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\ingreso_visita_service.rs:205:1
    |
205 | / pub async fn get_activos(
206 | | ) -> Result<Vec<crate::domain::ingreso_visita::IngresoVisitaPopulated>, IngresoVisitaError> {
207 | |     // TODO: Implementar query real.
208 | |     Ok(vec![])
209 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: unused `async` for function with no await statements
   --> src\services\lista_negra_service.rs:333:1
    |
333 | / pub async fn search_personas_for_block(
334 | |     query: &str,
335 | | ) -> Result<Vec<crate::models::lista_negra::PersonaSearchResult>, String> {
...   |
339 | |     Ok(vec![])
340 | | }
    | |_^
    |
    = help: consider removing the `async` from this function
    = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.91.0/index.html#unused_async

warning: `mega-brisas` (lib) generated 168 warnings (run `cargo clippy --fix --lib -p mega-brisas` to apply 1 suggestion)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 9.78s
